<!DOCTYPE html>
<html>
  <head>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <meta name="robots" content="noindex" />

    <title data-bind="app-title" data-prop="innerText" data-class="info">
      Heatflask
    </title>

    <link rel="shortcut icon" href="../images/favicon.ico" />
    <link rel="apple-touch-icon" href="../images/logo.png" />
  </head>

  <body>
    <div
      id="sidebar"
      class="sidebar collapsed"
      data-class="current-user"
      data-bind="id"
      data-attr="data-authenticated"
    >
      <!-- Nav tabs -->
      <div class="sidebar-tabs">
        <ul role="tablist">
          <li>
            <a href="#home" role="tab"><i class="fas fa-bars"></i></a>
          </li>

          <li>
            <a href="#activities" role="tab"><i class="fas fa-list"></i></a>
          </li>

          <!-- Only show this tab if current user is authenticated -->
          <li
            class="conditional-show"
            data-class="current-user"
            data-bind="id"
            data-attr="data-show"
          >
            <a href="#profile" role="tab"><i class="fas fa-user"></i></a>
          </li>

          <li>
            <a href="#controls" role="tab"><i class="fas fa-sliders-h"></i></a>
          </li>

          <li>
            <a href="#info-pane" role="tab"><i class="fas fa-info"></i></a>
          </li>
        </ul>
      </div>

      <!-- Tab panes -->
      <div class="sidebar-content">
        <!-- Main Query tab -->
        <div class="sidebar-pane" id="home">
          <h1 class="sidebar-header">
            <a
              href="#"
              data-bind="strava-url"
              data-prop="href"
              data-class="target-user"
              target="_blank"
              ><button
                class="avatar"
                data-class="target-user"
                data-bind="avatar"
                data-attr="data-url"
              ></button
            ></a>

            <span
              data-bind="username"
              data-prop="innerText"
              data-class="target-user"
              >(user)</span
            >'s map

            <span class="sidebar-close">
              <i class="fas fa-caret-left"></i>
            </span>
          </h1>

          <h3>Activities query:</h3>

          <span
            class="query days activities"
            data-bind="queryType"
            data-attr="data-queryType"
            data-event="none"
          >
            <input
              type="number"
              value="0"
              min="1"
              max="9999"
              data-bind="quantity"
              data-class="query"
            />
          </span>

          <select data-bind="queryType" data-class="query">
            <option value="days">recent days</option>
            <option value="activities" selected>recent activities</option>
            <option value="ids">Activity IDs</option>
            <option value="dates">Date-Range</option>
            <option value="key">Key</option>
          </select>

          <br />
          <div
            class="query key"
            data-bind="queryType"
            data-attr="data-queryType"
            data-event="none"
          >
            <input type="text" value="" data-bind="key" data-class="query" />
          </div>

          <div
            class="query ids"
            data-bind="queryType"
            data-attr="data-queryType"
            data-event="none"
          >
            <textarea
              autocomplete="on"
              placeholder="enter activity ids here"
              spellcheck="false"
              data-bind="ids"
              data-class="query"
            >
            </textarea>
          </div>

          <div
            class="query dates"
            data-bind="queryType"
            data-attr="data-queryType"
            data-event="none"
          >
            After:
            <input
              type="date"
              class="qdate"
              data-bind="after"
              data-class="query"
            />
            <span class="validity"></span>
            <br />
            Before:
            <input
              type="date"
              class="qdate"
              data-bind="before"
              data-class="query"
            />
            <span class="validity"></span>
          </div>

          <br />

          <label>
            <input
              type="checkbox"
              data-bind="autozoom"
              data-prop="checked"
              data-class="visual"
            />
            <i class="fas fa-search-location"></i>
            Auto-Zoom
            <i class="fas fa-bullseye"></i>
            to query after import
          </label>

          <br />
          <div class="info-message"></div>

          <br />

          <!-- display only if app.flag.importing is false -->
          <button
            type="button"
            class="btn btn-a btn-sm smooth conditional-hide"
            data-action="query"
            data-class="flag"
            data-bind="importing"
            data-attr="data-hide"
          >
            <i class="fas fa-cloud-download-alt"></i>
            Query
          </button>

          <div
            class="conditional-show"
            data-class="flag"
            data-bind="importing"
            data-attr="data-show"
          >
            <!-- only display this button if app.flag.importing is true -->
            <div class="progress">
              <progress class="progbar"></progress>
            </div>
            <br />
            <button
              type="button"
              class="btn btn-c btn-sm smooth"
              data-action="abort-query"
            >
              <i class="fas fa-times-circle"></i>
              Abort Import
            </button>
          </div>

          <br />

          <!-- Displayed only if current-user's id is set (logged-in) -->
          <div
            class="conditional-show"
            data-class="current-user"
            data-bind="id"
            data-attr="data-show"
          >
            You are authenticated as
            <a
              href="#"
              target="_blank"
              data-bind="strava-url"
              data-prop="href"
              data-class="current-user"
            >
              <span
                data-class="current-user"
                data-bind="username"
                data-prop="innerText"
                ><button
                  class="avatar"
                  data-class="current-user"
                  data-bind="avatar"
                  data-prop="data-url"
                ></button
                >(current-user)</span
              >
            </a>
            <br /><br />

            <button type="button" class="btn btn-c btn-sm" data-action="logout">
              <i class="fas fa-sign-out-alt"></i>
              Log Out
            </button>
          </div>

          <br />

          <!-- Displayed only if current-user id is not set (not logged-in) -->
          <div
            class="conditional-hide"
            data-class="current-user"
            data-bind="id"
            data-attr="data-hide"
          >
            Create an account and/or log in.<br />
            <button class="strava-auth" data-action="login"></button>
          </div>

          <div
            data-bind="error-message"
            data-prop="innerHTML"
            data-class="info"
          ></div>
          <br />

          <!-- <div class="paypal-button"></div> -->
        </div>

        <!-- Profile & User Settings Tab -->
        <div class="sidebar-pane" id="profile">
          <h1 class="sidebar-header">
            <a
              href="#"
              target="_blank"
              data-bind="strava-url"
              data-prop="href"
              data-class="current-user"
              ><button
                class="avatar"
                data-class="target-user"
                data-bind="avatar"
                data-attr="data-url"
              ></button
            ></a>

            <span
              data-bind="username"
              data-prop="innerText"
              data-class="current-user"
            ></span>

            <span class="sidebar-close">
              <i class="fas fa-caret-left"></i>
            </span>
          </h1>
          <h3>
            <span
              data-bind="firstname"
              data-prop="innerText"
              data-class="current-user"
              >first</span
            >
            <span
              data-bind="lastname"
              data-prop="innerText"
              data-class="current-user"
              >last</span
            >
          </h3>

          <a href="https://www.strava.com/settings/profile" target="_blank">
            <button
              class="avatar"
              data-bind="avatar"
              data-prop="data-url"
              data-class="current-user"
            ></button>
          </a>

          <br /><br />
          We index your activity summaries for fast access.
          <br />

          <button
            type="button"
            class="btn btn-a btn-sm"
            data-action="view-index"
          >
            <i class="fa fa-list-alt"></i>
            View index
          </button>
          <br />
          <hr />

          <div>
            <label
              ><input
                type="checkbox"
                data-class="current-user"
                data-bind="public"
                data-prop="checked"
                data-event="change"
              />
              Public Profile
              <a
                href="#"
                target="_blank"
                data-bind="public-users-url"
                data-prop="href"
                data-class="info"
              >
                (<i class="fas fa-users"></i>
                Public Users)
              </a>
            </label>
          </div>

          <br /><br /><br />

          <button type="button" data-action="logout" class="btn btn-c btn-sm">
            <i class="fas fa-sign-out-alt"></i>
            Log Out
          </button>

          <br />
          <hr />
          <br /><br />

          <button type="button" data-action="delete" class="btn btn-c btn-sm">
            <i class="fas fa-user-alt-slash"></i>
            Delete Account
          </button>

          <br />
          <div class="paypal-button"></div>
        </div>

        <!-- App Info Tab -->
        <div class="sidebar-pane" id="info-pane">
          <h1 class="sidebar-header">
            Info
            <span class="sidebar-close">
              <i class="fas fa-caret-left"></i>
            </span>
          </h1>

          <div id="info-tab"></div>
        </div>

        <!-- Activity List/Table Tab -->
        <div class="sidebar-pane" id="activities">
          <h1 class="sidebar-header">
            Rendered Activities
            <span class="sidebar-close">
              <i class="fas fa-caret-left"></i>
            </span>
          </h1>
          <button
            type="button"
            class="btn btn-b btn-sm"
            data-action="selection-clear"
          >
            Clear Selection
          </button>

          <button
            type="button"
            class="btn btn-a btn-sm"
            data-action="selection-render"
          >
            Render selected
          </button>

          <br /><br />

          <input
            type="checkbox"
            data-bind="zoomToSelection"
            data-prop="checked"
            data-class="flag"
          />
          <i class="fas fa-search-plus"></i>
          <i class="far fa-object-group"></i>
          <i class="fas fa-search-minus"></i>
          Zoom to selection

          <div id="items-container">
            <table id="items"></table>
          </div>
        </div>

        <!-- Controls Tab -->
        <div class="sidebar-pane" id="controls">
          <h1 class="sidebar-header">
            Layer Settings
            <span class="sidebar-close">
              <i class="fas fa-caret-left"></i>
            </span>
          </h1>

          <div>
            <h4>System Constants</h4>

            <!-- Timescale input -->
            <div class="dot-const-slider">
              <label for="dot-speed"
                ><h5>Timescale:</h5>
                &tau; =
                <span
                  data-bind="tau-info"
                  data-class="info"
                  data-prop="innerText"
                ></span
              ></label>
              <br />
              <input
                type="range"
                min="0"
                max="1"
                step="0.001"
                class="dot-const"
                id="dot-speed"
                data-bind="s"
                data-class="visual"
                data-event="input"
              />
            </div>

            <!-- Period input -->
            <div class="dot-const-slider">
              <label for="dot-sep"
                ><h5>Period:</h5>
                &Tau; =
                <span
                  data-bind="T-info"
                  data-prop="innerText"
                  data-class="info"
                ></span
              ></label>
              <br />
              <input
                type="range"
                min="0.25"
                max="30"
                step="0.25"
                class="dot-const"
                id="dot-sep"
                data-bind="T"
                data-class="visual"
                data-event="input"
              />
            </div>

            <hr />
            <div class="dot-const-info"></div>
            <hr />

            <!-- Dot-alpha -->
            <div class="dot-const-slider">
              <label for="dot-alpha"><h5>&alpha;</h5></label>
              <br />
              <input
                type="range"
                min="0"
                max="1"
                step="0.01"
                class="dot-const"
                id="dot-alpha"
                data-bind="alpha"
                data-event="input"
                data-class="visual"
              />
            </div>

            <!-- Dot-size -->
            <div class="dot-const-slider">
              <label for="dot-size"><h5>Size</h5></label>
              <br />
              <input
                type="range"
                min="1"
                max="20"
                step="0.1"
                class="dot-const"
                id="dot-size"
                data-bind="sz"
                data-event="input"
                data-class="visual"
              />
            </div>

            <hr />
            <span>
              <input
                type="checkbox"
                id="showPaths"
                data-bind="paths"
                data-prop="checked"
                data-class="visual"
              />
              <label for="showPaths">Show Paths</label>
            </span>

            <span>
              <input
                type="checkbox"
                id="showShadows"
                data-bind="shadows"
                data-prop="checked"
                data-class="visual"
              />
              <label for="showShadows">Shadows (CPU intensive)</label>
            </span>
          </div>
        </div>
      </div>
    </div>

    <div id="map" class="sidebar-map"></div>
  </body>

  <!-- Data passed from the backend at serve-time will be here -->
  <div id="runtime-arguments">{{args|tojson|safe}}</div>

  <script src="../js/main.ts" type="module"></script>
</html>
